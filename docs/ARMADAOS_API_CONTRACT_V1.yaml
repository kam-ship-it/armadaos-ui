openapi: 3.0.3
info:
  title: ArmadaOS API Contract
  description: |
    # ArmadaOS API Contract v1.0
    
    This contract defines the interface between the ArmadaOS Frontend (armadaos-ui) 
    and the ArmadaOS Backend (armadaos-genesis).
    
    ## Contract Guarantees
    
    - **Immutable**: Once published, endpoints do not change
    - **Versioned**: Breaking changes require new version
    - **Complete**: Every request/response fully specified
    - **Testable**: Can be validated automatically
    
    ## Authentication
    
    All endpoints (except /health) require Bearer token authentication.
    
    ```
    Authorization: Bearer <token>
    ```
    
    ## Base URL
    
    Production: `https://api.armadaos.com`
    Development: `http://localhost:8080`
    
  version: "1.0.0"
  contact:
    name: ArmadaOS
    url: https://github.com/kam-ship-it/ArmadaOS

servers:
  - url: https://api.armadaos.com
    description: Production
  - url: http://localhost:8080
    description: Development

tags:
  # =============================================================================
  # TIER 1: CORE INTELLIGENCE (Components 1-10)
  # =============================================================================
  - name: Health
    description: System health endpoints
  - name: Gateway
    description: The One Gateway - Single entry point for all API requests
  - name: Constitution
    description: Constitution Enforcer - Validates all actions against the Constitution
  - name: EventStore
    description: Event Store - Immutable audit log of all system events
  - name: Validator
    description: Validator - Validates agent outputs before execution
  - name: RedTeam
    description: Red Team Agent - Adversarial testing of agent actions
  - name: Shadow
    description: System-Level Shadow - Monitors system health and compliance
  - name: AgentRuntime
    description: Agent Runtime - Executes agent logic
  - name: Orchestrator
    description: Orchestrator - Coordinates multi-agent workflows
  - name: ActionQueue
    description: Action Queue - Manages pending actions
  
  # =============================================================================
  # TIER 2: OPERATIONAL SERVICES (Components 11-25)
  # =============================================================================
  - name: Context
    description: Context Engine - Agent memory and context assembly
  - name: Sandbox
    description: Sandbox Bridge - Agent execution environment
  - name: Architect
    description: Master Architect - Document indexing and search
  - name: Treasury
    description: Treasury - Cost tracking and budget enforcement
  - name: StateManager
    description: State Manager - Tracks current state of all systems
  - name: ContextInjector
    description: Context Injector - Injects context into agent prompts
  - name: Weaviate
    description: Weaviate - Vector database for semantic search
  - name: ApprovalEngine
    description: Approval Engine - Manages Chairman approval workflows
  - name: CostModel
    description: Cost Model - Estimates cost of actions before execution
  - name: MemoryController
    description: Memory Controller - Manages agent working memory
  - name: RAMAgent
    description: RAM Agent - In-memory cache for frequently accessed data
  - name: GOD Mode
    description: Chairman control and oversight (API + Console)
  - name: ServiceAdapters
    description: Service Adapters - Connect to external APIs
  - name: Backup
    description: Backup Service - Backup and restore for critical data
  
  # =============================================================================
  # TIER 3: INFRASTRUCTURE & OBSERVABILITY (Components 26-41)
  # =============================================================================
  - name: Mesh
    description: Linkerd Service Mesh - mTLS, circuit breaking, retries
  - name: Observability
    description: OpenTelemetry - Distributed tracing and observability
  - name: Secrets
    description: AWS Secrets Manager - Secure secret storage and rotation
  - name: LoadBalancer
    description: AWS ALB/NLB - Load balancing
  - name: Orchestration
    description: ECS/Kubernetes - Container orchestration
  - name: HealthMonitor
    description: Health Monitor - Individual service health checks
  - name: HealthAggregator
    description: Health Aggregator - Holistic system health view
  - name: Rollback
    description: Rollback Mechanism - Automated rollback of failed deployments
  - name: DeadManSwitch
    description: Dead Man's Switch - Fail-safe if smart systems fail
  - name: DependencyGraph
    description: Dependency Graph - Machine-readable build order
  - name: ConfigManagement
    description: Configuration Management - Manages environment configuration
  - name: ServiceDiscovery
    description: Service Discovery - How services find each other
  - name: DisasterRecovery
    description: Disaster Recovery - Cross-region backup and recovery
  - name: ShadowOfShadow
    description: Shadow of Shadow - Backup monitor for System-Level Shadow
  - name: CICD
    description: CI/CD Pipelines - Automated build, test, deploy
  - name: Canary
    description: Canary Deployment Service - Progressive rollouts
  - name: Scheduler
    description: Manage scheduled tasks, cron jobs, and timeouts
  - name: Notifications
    description: Manage user notifications and alerts
  
  # =============================================================================
  # TIER 4: UI & GENERATIVE (Component 42 + Extensions)
  # =============================================================================
  - name: Generative UI
    description: AI-powered dynamic interface generation (PLANNED - BATCH-180)

paths:
  # =============================================================================
  # HEALTH
  # =============================================================================
  /health:
    get:
      tags:
        - Health
      summary: Gateway health check
      description: Returns health status of the API gateway and all connected services
      operationId: getHealth
      security: []
      responses:
        '200':
          description: System healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
              example:
                status: healthy
                version: "1.0.0"
                services:
                  context_engine: connected
                  sandbox_bridge: connected
                  master_architect: connected
                  constitution_enforcer: connected
                  event_store: connected

  # =============================================================================
  # CONTEXT ENGINE
  # =============================================================================
  /v1/context/assemble:
    post:
      tags:
        - Context
      summary: Assemble context for agent
      description: |
        Assembles a complete context package for an agent, including:
        - Tier 1: Always-loaded constitutional documents (30,000 tokens)
        - Tier 2: Predictive context based on task (40,000 tokens)
        - Tier 3: RAG search results (30,000 tokens)
        
        Total: 100,000 tokens of guaranteed context.
      operationId: assembleContext
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ContextAssembleRequest'
            example:
              agent_id: "atlas-001"
              task_type: "batch_execution"
              query: "BATCH-177 Infrastructure Wiring"
              topics:
                - infrastructure
                - ecs
                - deployment
      responses:
        '200':
          description: Context assembled successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContextAssembleResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalError'

  /v1/context/invalidate:
    post:
      tags:
        - Context
      summary: Invalidate context cache
      description: Invalidates cached context for a specific agent or all agents
      operationId: invalidateContext
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ContextInvalidateRequest'
            example:
              agent_id: "atlas-001"
      responses:
        '200':
          description: Cache invalidated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'

  # =============================================================================
  # SANDBOX BRIDGE
  # =============================================================================
  /v1/sandbox/execute:
    post:
      tags:
        - Sandbox
      summary: Execute shell command
      description: |
        Executes a shell command in the agent's sandbox environment.
        
        **Constitution Enforcement**: Commands are validated against the constitution
        before execution. Blocked commands will return 403.
      operationId: executeCommand
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExecuteRequest'
            example:
              agent_id: "atlas-001"
              command: "ls -la /workspace"
              timeout: 30
      responses:
        '200':
          description: Command executed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExecuteResponse'
        '403':
          description: Command blocked by constitution
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConstitutionBlockResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /v1/sandbox/file/write:
    post:
      tags:
        - Sandbox
      summary: Write file
      description: Writes content to a file in the agent's workspace
      operationId: writeFile
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FileWriteRequest'
            example:
              agent_id: "atlas-001"
              path: "/workspace/output.txt"
              content: "Hello, World!"
              mode: "overwrite"
      responses:
        '200':
          description: File written
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '403':
          description: Path blocked by constitution
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConstitutionBlockResponse'

  /v1/sandbox/file/read:
    get:
      tags:
        - Sandbox
      summary: Read file
      description: Reads content from a file in the agent's workspace
      operationId: readFile
      parameters:
        - name: agent_id
          in: query
          required: true
          schema:
            type: string
        - name: path
          in: query
          required: true
          schema:
            type: string
      responses:
        '200':
          description: File content
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FileReadResponse'
        '404':
          description: File not found

  /v1/sandbox/git/clone:
    post:
      tags:
        - Sandbox
      summary: Clone repository
      description: Clones a Git repository into the agent's workspace
      operationId: gitClone
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GitCloneRequest'
            example:
              agent_id: "atlas-001"
              repo_url: "https://github.com/kam-ship-it/ArmadaOS.git"
              destination: "/workspace/ArmadaOS"
      responses:
        '200':
          description: Repository cloned
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /v1/sandbox/git/commit:
    post:
      tags:
        - Sandbox
      summary: Commit changes
      description: Commits staged changes in a repository
      operationId: gitCommit
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GitCommitRequest'
            example:
              agent_id: "atlas-001"
              repo_path: "/workspace/ArmadaOS"
              message: "BATCH-177: Infrastructure wiring complete"
              files:
                - "."
      responses:
        '200':
          description: Changes committed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GitCommitResponse'

  /v1/sandbox/git/push:
    post:
      tags:
        - Sandbox
      summary: Push to remote
      description: Pushes committed changes to the remote repository
      operationId: gitPush
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GitPushRequest'
            example:
              agent_id: "atlas-001"
              repo_path: "/workspace/ArmadaOS"
              branch: "main"
      responses:
        '200':
          description: Changes pushed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # =============================================================================
  # MASTER ARCHITECT
  # =============================================================================
  /v1/architect/index:
    post:
      tags:
        - Architect
      summary: Index document
      description: Indexes a document into the vector database for semantic search
      operationId: indexDocument
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IndexRequest'
            example:
              path: "/ArmadaOS/protocols/AOSP-117.md"
              content: "# AOSP-117: Autonomous Troubleshooting Protocol..."
              metadata:
                type: "protocol"
                tier: 1
      responses:
        '200':
          description: Document indexed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IndexResponse'

  /v1/architect/search:
    post:
      tags:
        - Architect
      summary: Search indexed documents
      description: Performs semantic search across indexed documents
      operationId: searchDocuments
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SearchRequest'
            example:
              query: "How to deploy to ECS"
              limit: 10
              filters:
                type: "protocol"
      responses:
        '200':
          description: Search results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SearchResponse'

  /v1/architect/webhook:
    post:
      tags:
        - Architect
      summary: GitHub webhook receiver
      description: Receives GitHub webhook events to trigger automatic indexing
      operationId: githubWebhook
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Webhook processed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # =============================================================================
  # GENERATIVE UI (PLANNED - Implementation in BATCH-180)
  # =============================================================================
  # NOTE: These endpoints are PLANNED. They define the contract for the
  # Generative UI feature. Backend implementation will be in BATCH-180.
  # Frontend components will be built in BATCH-135.
  
  /v1/ui/generate:
    post:
      tags:
        - Generative UI
      summary: Generate UI from user intent (PLANNED)
      description: |
        Analyzes user input and generates a custom UI specification.
        Uses LLM to determine optimal layout, components, and interactions.
        
        **Status: PLANNED** - Endpoint will be implemented in BATCH-180.
        
        The response contains:
        - Layout definition (single-column, two-column, dashboard)
        - Component specifications with props and positions
        - Animation definitions
        - COS companion context
      operationId: generateUI
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GenerateUIRequest'
            example:
              user_input: "I want to learn Spanish"
              user_context:
                user_id: "user-001"
                preferences:
                  theme: "dark"
              session_history: []
      responses:
        '200':
          description: UI specification generated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenerateUIResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalError'

  /v1/ui/components:
    get:
      tags:
        - Generative UI
      summary: List available UI components (PLANNED)
      description: |
        Returns the component library available for UI generation.
        
        **Status: PLANNED** - Endpoint will be implemented in BATCH-180.
        
        Components include:
        - Navigation: roadmap, timeline, stepper
        - Input: form, multiChoice, slider
        - Display: card, grid, list
        - Interactive: button, modal, tooltip
        - Data: chart, table, metric
        - AI: cosCompanion, suggestion, insight
      operationId: listUIComponents
      responses:
        '200':
          description: Component library
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComponentListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /v1/ui/layouts:
    get:
      tags:
        - Generative UI
      summary: List available layouts (PLANNED)
      description: |
        Returns available layout templates for UI generation.
        
        **Status: PLANNED** - Endpoint will be implemented in BATCH-180.
      operationId: listUILayouts
      responses:
        '200':
          description: Layout templates
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LayoutListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /v1/ui/render:
    post:
      tags:
        - Generative UI
      summary: Render UI specification (PLANNED)
      description: |
        Takes a UI specification and returns rendered HTML/React components.
        
        **Status: PLANNED** - Endpoint will be implemented in BATCH-180.
      operationId: renderUI
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RenderUIRequest'
      responses:
        '200':
          description: Rendered UI
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RenderUIResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /v1/ui/templates:
    get:
      tags:
        - Generative UI
      summary: List pre-built UI templates (PLANNED)
      description: |
        Returns pre-built UI templates for common use cases.
        
        **Status: PLANNED** - Endpoint will be implemented in BATCH-180.
        
        Templates include:
        - Learning journey
        - Business launch
        - Health tracker
        - Project planner
      operationId: listUITemplates
      responses:
        '200':
          description: Template library
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TemplateListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'

  # =============================================================================
  # GOD MODE
  # =============================================================================
  /v1/god/status:
    get:
      tags:
        - GOD Mode
      summary: System status overview
      description: |
        Returns comprehensive system status including:
        - All service health
        - Active agents
        - Pending approvals
        - Recent events
        - Resource utilization
      operationId: getSystemStatus
      responses:
        '200':
          description: System status
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SystemStatusResponse'

  /v1/god/agents:
    get:
      tags:
        - GOD Mode
      summary: List all agents
      description: Returns list of all registered agents and their current status
      operationId: listAgents
      responses:
        '200':
          description: Agent list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentListResponse'

  /v1/god/agents/{agent_id}:
    get:
      tags:
        - GOD Mode
      summary: Get agent details
      description: Returns detailed information about a specific agent
      operationId: getAgent
      parameters:
        - name: agent_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Agent details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentDetailResponse'

  /v1/god/pause:
    post:
      tags:
        - GOD Mode
      summary: Pause all agent activity
      description: |
        **KILL SWITCH**: Immediately pauses all agent activity.
        Agents will complete their current action and then wait.
      operationId: pauseAllAgents
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PauseRequest'
            example:
              reason: "Chairman review required"
      responses:
        '200':
          description: All agents paused
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /v1/god/resume:
    post:
      tags:
        - GOD Mode
      summary: Resume agent activity
      description: Resumes agent activity after a pause
      operationId: resumeAllAgents
      responses:
        '200':
          description: All agents resumed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /v1/god/override:
    post:
      tags:
        - GOD Mode
      summary: Override agent decision
      description: |
        Allows the Chairman to override a pending agent decision.
        The override is logged to the event store.
      operationId: overrideDecision
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OverrideRequest'
            example:
              decision_id: "dec-12345"
              action: "approve"
              reason: "Chairman approved manually"
      responses:
        '200':
          description: Decision overridden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /v1/god/events:
    get:
      tags:
        - GOD Mode
      summary: Get recent events
      description: Returns recent system events from the event store
      operationId: getEvents
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            default: 100
        - name: agent_id
          in: query
          schema:
            type: string
        - name: event_type
          in: query
          schema:
            type: string
      responses:
        '200':
          description: Event list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EventListResponse'

  /v1/god/approvals:
    get:
      tags:
        - GOD Mode
      summary: Get pending approvals
      description: Returns list of actions awaiting Chairman approval
      operationId: getPendingApprovals
      responses:
        '200':
          description: Pending approvals
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApprovalListResponse'

  /v1/god/approvals/{approval_id}:
    post:
      tags:
        - GOD Mode
      summary: Approve or reject action
      description: Chairman approves or rejects a pending action
      operationId: processApproval
      parameters:
        - name: approval_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApprovalDecisionRequest'
            example:
              decision: "approve"
              reason: "Looks good"
      responses:
        '200':
          description: Approval processed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # GOD MODE: BATCHES
  /v1/god/batches:
    get:
      tags:
        - GOD Mode
      summary: List all batches
      description: Returns list of all BATCHes and their current status for the Battlefield view
      operationId: listBatches
      parameters:
        - name: status
          in: query
          schema:
            type: string
            enum: [queued, in_progress, completed, blocked]
      responses:
        '200':
          description: Batch list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchListResponse'

  /v1/god/batches/{batch_id}:
    get:
      tags:
        - GOD Mode
      summary: Get batch details
      description: Returns detailed information about a specific BATCH including checklist and activity
      operationId: getBatch
      parameters:
        - name: batch_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Batch details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchDetailResponse'

  # GOD MODE: COMPONENTS (Architecture Lens)
  /v1/god/components:
    get:
      tags:
        - GOD Mode
      summary: List all 42 components
      description: Returns list of all 42 components grouped by tier with health status
      operationId: listComponents
      parameters:
        - name: tier
          in: query
          schema:
            type: string
            enum: [core_substrate, core_services, infrastructure]
      responses:
        '200':
          description: Component list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComponentListResponse'

  /v1/god/components/{component_id}:
    get:
      tags:
        - GOD Mode
      summary: Get component details
      description: Returns detailed information about a specific component
      operationId: getComponent
      parameters:
        - name: component_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Component details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComponentDetailResponse'

  /v1/god/components/{component_id}/metrics:
    get:
      tags:
        - GOD Mode
      summary: Get component metrics
      description: Returns real-time metrics for a specific component
      operationId: getComponentMetrics
      parameters:
        - name: component_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Component metrics
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComponentMetricsResponse'

  /v1/god/components/{component_id}/restart:
    post:
      tags:
        - GOD Mode
      summary: Restart component
      description: Triggers a restart of the specified component
      operationId: restartComponent
      parameters:
        - name: component_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RestartRequest'
      responses:
        '200':
          description: Component restart initiated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # GOD MODE: THREATS (Battlefield Lens)
  /v1/god/threats:
    get:
      tags:
        - GOD Mode
      summary: Get threat feed
      description: Returns alerts from red-team-agent and drift-monitor
      operationId: getThreats
      parameters:
        - name: severity
          in: query
          schema:
            type: string
            enum: [critical, high, medium, low]
        - name: acknowledged
          in: query
          schema:
            type: boolean
      responses:
        '200':
          description: Threat feed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ThreatListResponse'

  # GOD MODE: LOOPS (Open items requiring attention)
  /v1/god/loops:
    get:
      tags:
        - GOD Mode
      summary: Get open loops
      description: Returns count and list of unresolved tasks/decisions requiring attention
      operationId: getOpenLoops
      responses:
        '200':
          description: Open loops
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OpenLoopsResponse'

  # =============================================================================
  # NEXUS AGENT (Cognitive Interface)
  # =============================================================================
  /v1/nexus/query:
    post:
      tags:
        - Nexus
      summary: Query Nexus
      description: Send a natural language query to Nexus and receive an intelligent response
      operationId: queryNexus
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NexusQueryRequest'
            example:
              query: "Why did the Context Injector fail?"
              context:
                current_view: "architecture"
                selected_component: "context-injector"
      responses:
        '200':
          description: Nexus response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NexusQueryResponse'

  /v1/nexus/interpret:
    get:
      tags:
        - Nexus
      summary: Interpret event (Causal Chain Analysis)
      description: Nexus analyzes an event and provides a causal chain explanation
      operationId: interpretEvent
      parameters:
        - name: event_id
          in: query
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Causal chain analysis
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NexusInterpretResponse'

  /v1/nexus/challenge:
    get:
      tags:
        - Nexus
      summary: Pre-mortem analysis
      description: Nexus provides adversarial questions for a specific BATCH
      operationId: challengeBatch
      parameters:
        - name: batch_id
          in: query
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Pre-mortem analysis
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NexusChallengeResponse'

  /v1/nexus/explain:
    get:
      tags:
        - Nexus
      summary: Explain Constitution article
      description: Nexus explains a specific Constitution article with history and rationale
      operationId: explainArticle
      parameters:
        - name: article_id
          in: query
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Article explanation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NexusExplainResponse'

  /v1/nexus/attention:
    get:
      tags:
        - Nexus
      summary: Get attention queue
      description: Returns prioritized list of items needing Chairman review
      operationId: getAttentionQueue
      responses:
        '200':
          description: Attention queue
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NexusAttentionResponse'

  /v1/nexus/alerts:
    get:
      tags:
        - Nexus
      summary: Get Nexus alerts
      description: Returns unread alerts from Nexus
      operationId: getNexusAlerts
      parameters:
        - name: unread_only
          in: query
          schema:
            type: boolean
            default: true
      responses:
        '200':
          description: Nexus alerts
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NexusAlertsResponse'

  # =============================================================================
  # CONSTITUTION ENFORCER (Component 3)
  # =============================================================================
  /v1/constitution/validate:
    post:
      tags:
        - Constitution
      summary: Validate action against Constitution
      description: Checks if a proposed action violates the Constitution
      operationId: validateAction
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConstitutionValidateRequest'
      responses:
        '200':
          description: Validation result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConstitutionValidateResponse'

  /v1/constitution/articles:
    get:
      tags:
        - Constitution
      summary: Get all Constitution articles
      description: Returns the full Constitution for reference
      operationId: getConstitution
      responses:
        '200':
          description: Constitution articles
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConstitutionArticlesResponse'

  /v1/constitution/violations:
    get:
      tags:
        - Constitution
      summary: Get recent violations
      description: Returns recent Constitution violations for audit
      operationId: getViolations
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            default: 100
        - name: agent_id
          in: query
          schema:
            type: string
      responses:
        '200':
          description: List of violations
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ViolationListResponse'

  # =============================================================================
  # EVENT STORE (Component 4)
  # =============================================================================
  /v1/events:
    get:
      tags:
        - EventStore
      summary: Query events
      description: Query the immutable event log with filters
      operationId: queryEvents
      parameters:
        - name: agent_id
          in: query
          schema:
            type: string
        - name: event_type
          in: query
          schema:
            type: string
        - name: start_time
          in: query
          schema:
            type: string
            format: date-time
        - name: end_time
          in: query
          schema:
            type: string
            format: date-time
        - name: limit
          in: query
          schema:
            type: integer
            default: 100
      responses:
        '200':
          description: Event list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EventQueryResponse'

  /v1/events/{event_id}:
    get:
      tags:
        - EventStore
      summary: Get event by ID
      description: Retrieve a specific event by its ID
      operationId: getEvent
      parameters:
        - name: event_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Event details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EventDetail'

  /v1/events/stream:
    get:
      tags:
        - EventStore
      summary: Stream events (SSE)
      description: Server-sent events stream for real-time event monitoring
      operationId: streamEvents
      parameters:
        - name: agent_id
          in: query
          schema:
            type: string
        - name: event_type
          in: query
          schema:
            type: string
      responses:
        '200':
          description: Event stream
          content:
            text/event-stream:
              schema:
                type: string

  # =============================================================================
  # VALIDATOR (Component 5)
  # =============================================================================
  /v1/validator/validate:
    post:
      tags:
        - Validator
      summary: Validate agent output
      description: Validates agent output before execution
      operationId: validateOutput
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ValidatorRequest'
      responses:
        '200':
          description: Validation result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidatorResponse'

  /v1/validator/rules:
    get:
      tags:
        - Validator
      summary: Get validation rules
      description: Returns all active validation rules
      operationId: getValidationRules
      responses:
        '200':
          description: Validation rules
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationRulesResponse'

  # =============================================================================
  # RED TEAM AGENT (Component 6)
  # =============================================================================
  /v1/redteam/analyze:
    post:
      tags:
        - RedTeam
      summary: Adversarial analysis
      description: Red team analyzes proposed action for vulnerabilities
      operationId: redteamAnalyze
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RedTeamRequest'
      responses:
        '200':
          description: Analysis result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RedTeamResponse'

  /v1/redteam/reports:
    get:
      tags:
        - RedTeam
      summary: Get red team reports
      description: Returns historical red team analysis reports
      operationId: getRedTeamReports
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
      responses:
        '200':
          description: Report list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RedTeamReportsResponse'

  # =============================================================================
  # SYSTEM-LEVEL SHADOW (Component 7)
  # =============================================================================
  /v1/shadow/status:
    get:
      tags:
        - Shadow
      summary: Get Shadow status
      description: Returns current Shadow monitoring status
      operationId: getShadowStatus
      responses:
        '200':
          description: Shadow status
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShadowStatusResponse'

  /v1/shadow/alerts:
    get:
      tags:
        - Shadow
      summary: Get Shadow alerts
      description: Returns active and recent Shadow alerts
      operationId: getShadowAlerts
      parameters:
        - name: severity
          in: query
          schema:
            type: string
            enum: [critical, warning, info]
        - name: acknowledged
          in: query
          schema:
            type: boolean
      responses:
        '200':
          description: Alert list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShadowAlertsResponse'

  /v1/shadow/alerts/{alert_id}/acknowledge:
    post:
      tags:
        - Shadow
      summary: Acknowledge alert
      description: Mark an alert as acknowledged
      operationId: acknowledgeAlert
      parameters:
        - name: alert_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Alert acknowledged
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # =============================================================================
  # AGENT RUNTIME (Component 8)
  # =============================================================================
  /v1/runtime/agents:
    get:
      tags:
        - AgentRuntime
      summary: List running agents
      description: Returns all currently running agent instances
      operationId: listAgents
      responses:
        '200':
          description: Agent list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentListResponse'

  /v1/runtime/agents/{agent_id}:
    get:
      tags:
        - AgentRuntime
      summary: Get agent details
      description: Returns details of a specific agent instance
      operationId: getAgentDetails
      parameters:
        - name: agent_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Agent details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentDetailResponse'

  /v1/runtime/agents/{agent_id}/terminate:
    post:
      tags:
        - AgentRuntime
      summary: Terminate agent
      description: Forcefully terminate an agent instance
      operationId: terminateAgent
      parameters:
        - name: agent_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Agent terminated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # =============================================================================
  # ORCHESTRATOR (Component 9)
  # =============================================================================
  /v1/orchestrator/workflows:
    get:
      tags:
        - Orchestrator
      summary: List workflows
      description: Returns all active and recent workflows
      operationId: listWorkflows
      parameters:
        - name: status
          in: query
          schema:
            type: string
            enum: [active, completed, failed]
      responses:
        '200':
          description: Workflow list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkflowListResponse'

  /v1/orchestrator/workflows/{workflow_id}:
    get:
      tags:
        - Orchestrator
      summary: Get workflow details
      description: Returns details of a specific workflow
      operationId: getWorkflow
      parameters:
        - name: workflow_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Workflow details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkflowDetailResponse'

  /v1/orchestrator/workflows/{workflow_id}/cancel:
    post:
      tags:
        - Orchestrator
      summary: Cancel workflow
      description: Cancel an active workflow
      operationId: cancelWorkflow
      parameters:
        - name: workflow_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Workflow cancelled
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # =============================================================================
  # ACTION QUEUE (Component 10)
  # =============================================================================
  /v1/queue/actions:
    get:
      tags:
        - ActionQueue
      summary: List queued actions
      description: Returns all pending actions in the queue
      operationId: listQueuedActions
      parameters:
        - name: agent_id
          in: query
          schema:
            type: string
        - name: priority
          in: query
          schema:
            type: string
            enum: [high, medium, low]
      responses:
        '200':
          description: Action queue
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ActionQueueResponse'

  /v1/queue/actions/{action_id}:
    get:
      tags:
        - ActionQueue
      summary: Get action details
      description: Returns details of a specific queued action
      operationId: getQueuedAction
      parameters:
        - name: action_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Action details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ActionDetailResponse'

  /v1/queue/actions/{action_id}/cancel:
    post:
      tags:
        - ActionQueue
      summary: Cancel queued action
      description: Cancel a pending action
      operationId: cancelQueuedAction
      parameters:
        - name: action_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Action cancelled
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # =============================================================================
  # TREASURY (Component 14)
  # =============================================================================
  /v1/treasury/balance:
    get:
      tags:
        - Treasury
      summary: Get current balance
      description: Returns current budget balance and spending
      operationId: getTreasuryBalance
      responses:
        '200':
          description: Balance info
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TreasuryBalanceResponse'

  /v1/treasury/transactions:
    get:
      tags:
        - Treasury
      summary: Get transactions
      description: Returns transaction history
      operationId: getTreasuryTransactions
      parameters:
        - name: start_date
          in: query
          schema:
            type: string
            format: date
        - name: end_date
          in: query
          schema:
            type: string
            format: date
        - name: agent_id
          in: query
          schema:
            type: string
      responses:
        '200':
          description: Transaction list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TreasuryTransactionsResponse'

  /v1/treasury/budget:
    get:
      tags:
        - Treasury
      summary: Get budget configuration
      description: Returns budget limits and alerts
      operationId: getTreasuryBudget
      responses:
        '200':
          description: Budget config
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TreasuryBudgetResponse'
    put:
      tags:
        - Treasury
      summary: Update budget
      description: Update budget limits (Chairman only)
      operationId: updateTreasuryBudget
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TreasuryBudgetUpdateRequest'
      responses:
        '200':
          description: Budget updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # =============================================================================
  # STATE MANAGER (Component 15)
  # =============================================================================
  /v1/state:
    get:
      tags:
        - StateManager
      summary: Get system state
      description: Returns current state of all systems
      operationId: getSystemState
      responses:
        '200':
          description: System state
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SystemStateResponse'

  /v1/state/agents/{agent_id}:
    get:
      tags:
        - StateManager
      summary: Get agent state
      description: Returns current state of a specific agent
      operationId: getAgentState
      parameters:
        - name: agent_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Agent state
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentStateResponse'

  /v1/state/history:
    get:
      tags:
        - StateManager
      summary: Get state history
      description: Returns historical state snapshots
      operationId: getStateHistory
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            default: 100
      responses:
        '200':
          description: State history
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StateHistoryResponse'

  # =============================================================================
  # APPROVAL ENGINE (Component 18)
  # =============================================================================
  /v1/approvals:
    get:
      tags:
        - ApprovalEngine
      summary: List pending approvals
      description: Returns all pending approval requests
      operationId: listApprovals
      parameters:
        - name: status
          in: query
          schema:
            type: string
            enum: [pending, approved, rejected, expired]
      responses:
        '200':
          description: Approval list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApprovalListResponse'

  /v1/approvals/{approval_id}:
    get:
      tags:
        - ApprovalEngine
      summary: Get approval details
      description: Returns details of a specific approval request
      operationId: getApprovalDetails
      parameters:
        - name: approval_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Approval details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApprovalDetailResponse'

  /v1/approvals/{approval_id}/decide:
    post:
      tags:
        - ApprovalEngine
      summary: Decide on approval
      description: Approve or reject a pending request
      operationId: decideApproval
      parameters:
        - name: approval_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApprovalDecisionRequest'
      responses:
        '200':
          description: Decision recorded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # =============================================================================
  # COST MODEL (Component 19)
  # =============================================================================
  /v1/cost/estimate:
    post:
      tags:
        - CostModel
      summary: Estimate action cost
      description: Estimates the cost of a proposed action before execution
      operationId: estimateCost
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CostEstimateRequest'
      responses:
        '200':
          description: Cost estimate
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CostEstimateResponse'

  /v1/cost/models:
    get:
      tags:
        - CostModel
      summary: Get cost models
      description: Returns available cost models and their parameters
      operationId: getCostModels
      responses:
        '200':
          description: Cost models
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CostModelsResponse'

  # =============================================================================
  # MEMORY CONTROLLER (Component 20)
  # =============================================================================
  /v1/memory/{agent_id}:
    get:
      tags:
        - MemoryController
      summary: Get agent memory
      description: Returns working memory for an agent
      operationId: getAgentMemory
      parameters:
        - name: agent_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Agent memory
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentMemoryResponse'

  /v1/memory/{agent_id}/clear:
    post:
      tags:
        - MemoryController
      summary: Clear agent memory
      description: Clears working memory for an agent
      operationId: clearAgentMemory
      parameters:
        - name: agent_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Memory cleared
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # =============================================================================
  # RAM AGENT (Component 21)
  # =============================================================================
  /v1/cache/stats:
    get:
      tags:
        - RAMAgent
      summary: Get cache statistics
      description: Returns cache hit/miss statistics
      operationId: getCacheStats
      responses:
        '200':
          description: Cache stats
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CacheStatsResponse'

  /v1/cache/invalidate:
    post:
      tags:
        - RAMAgent
      summary: Invalidate cache
      description: Invalidate cache entries
      operationId: invalidateCache
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CacheInvalidateRequest'
      responses:
        '200':
          description: Cache invalidated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # =============================================================================
  # SERVICE ADAPTERS (Component 24)
  # =============================================================================
  /v1/adapters:
    get:
      tags:
        - ServiceAdapters
      summary: List service adapters
      description: Returns all configured external service adapters
      operationId: listAdapters
      responses:
        '200':
          description: Adapter list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdapterListResponse'

  /v1/adapters/{adapter_id}/status:
    get:
      tags:
        - ServiceAdapters
      summary: Get adapter status
      description: Returns status of a specific adapter
      operationId: getAdapterStatus
      parameters:
        - name: adapter_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Adapter status
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdapterStatusResponse'

  # =============================================================================
  # BACKUP SERVICE (Component 25)
  # =============================================================================
  /v1/backup/snapshots:
    get:
      tags:
        - Backup
      summary: List backups
      description: Returns all available backup snapshots
      operationId: listBackups
      responses:
        '200':
          description: Backup list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BackupListResponse'
    post:
      tags:
        - Backup
      summary: Create backup
      description: Creates a new backup snapshot
      operationId: createBackup
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BackupCreateRequest'
      responses:
        '202':
          description: Backup started
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BackupCreateResponse'

  /v1/backup/snapshots/{snapshot_id}:
    get:
      tags:
        - Backup
      summary: Get backup details
      description: Returns details of a specific backup
      operationId: getBackupDetails
      parameters:
        - name: snapshot_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Backup details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BackupDetailResponse'

  /v1/backup/restore:
    post:
      tags:
        - Backup
      summary: Restore from backup
      description: Initiates restore from a backup snapshot
      operationId: restoreBackup
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BackupRestoreRequest'
      responses:
        '202':
          description: Restore started
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BackupRestoreResponse'

  # =============================================================================
  # HEALTH MONITOR (Component 31)
  # =============================================================================
  /v1/health/services:
    get:
      tags:
        - HealthMonitor
      summary: Get all service health
      description: Returns health status of all individual services
      operationId: getAllServiceHealth
      responses:
        '200':
          description: Service health list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceHealthListResponse'

  /v1/health/services/{service_id}:
    get:
      tags:
        - HealthMonitor
      summary: Get service health
      description: Returns health status of a specific service
      operationId: getServiceHealth
      parameters:
        - name: service_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Service health
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceHealthResponse'

  # =============================================================================
  # HEALTH AGGREGATOR (Component 32)
  # =============================================================================
  /v1/health/aggregate:
    get:
      tags:
        - HealthAggregator
      summary: Get aggregated health
      description: Returns holistic system health view with trends
      operationId: getAggregatedHealth
      responses:
        '200':
          description: Aggregated health
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AggregatedHealthResponse'

  /v1/health/trends:
    get:
      tags:
        - HealthAggregator
      summary: Get health trends
      description: Returns health trends over time for predictive analysis
      operationId: getHealthTrends
      parameters:
        - name: period
          in: query
          schema:
            type: string
            enum: [hour, day, week]
            default: day
      responses:
        '200':
          description: Health trends
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthTrendsResponse'

  # =============================================================================
  # ROLLBACK MECHANISM (Component 33)
  # =============================================================================
  /v1/rollback/deployments:
    get:
      tags:
        - Rollback
      summary: List deployments
      description: Returns recent deployments available for rollback
      operationId: listDeployments
      responses:
        '200':
          description: Deployment list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeploymentListResponse'

  /v1/rollback/execute:
    post:
      tags:
        - Rollback
      summary: Execute rollback
      description: Rollback to a previous deployment
      operationId: executeRollback
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RollbackRequest'
      responses:
        '202':
          description: Rollback started
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RollbackResponse'

  # =============================================================================
  # DEAD MAN'S SWITCH (Component 34)
  # =============================================================================
  /v1/deadman/status:
    get:
      tags:
        - DeadManSwitch
      summary: Get dead man's switch status
      description: Returns status of the fail-safe mechanism
      operationId: getDeadManStatus
      responses:
        '200':
          description: Dead man's switch status
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeadManStatusResponse'

  /v1/deadman/heartbeat:
    post:
      tags:
        - DeadManSwitch
      summary: Send heartbeat
      description: Sends heartbeat to reset the dead man's switch timer
      operationId: sendHeartbeat
      responses:
        '200':
          description: Heartbeat received
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # =============================================================================
  # DEPENDENCY GRAPH (Component 35)
  # =============================================================================
  /v1/dependencies/graph:
    get:
      tags:
        - DependencyGraph
      summary: Get dependency graph
      description: Returns the machine-readable dependency graph
      operationId: getDependencyGraph
      responses:
        '200':
          description: Dependency graph
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DependencyGraphResponse'

  /v1/dependencies/build-order:
    get:
      tags:
        - DependencyGraph
      summary: Get build order
      description: Returns the correct build order based on dependencies
      operationId: getBuildOrder
      responses:
        '200':
          description: Build order
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BuildOrderResponse'

  # =============================================================================
  # CONFIGURATION MANAGEMENT (Component 36)
  # =============================================================================
  /v1/config:
    get:
      tags:
        - ConfigManagement
      summary: Get configuration
      description: Returns current system configuration
      operationId: getConfig
      responses:
        '200':
          description: Configuration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfigResponse'

  /v1/config/{key}:
    get:
      tags:
        - ConfigManagement
      summary: Get config value
      description: Returns a specific configuration value
      operationId: getConfigValue
      parameters:
        - name: key
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Config value
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfigValueResponse'
    put:
      tags:
        - ConfigManagement
      summary: Update config value
      description: Updates a configuration value (Chairman only)
      operationId: updateConfigValue
      parameters:
        - name: key
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConfigUpdateRequest'
      responses:
        '200':
          description: Config updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # =============================================================================
  # SERVICE DISCOVERY (Component 37)
  # =============================================================================
  /v1/discovery/services:
    get:
      tags:
        - ServiceDiscovery
      summary: List registered services
      description: Returns all registered services and their endpoints
      operationId: listRegisteredServices
      responses:
        '200':
          description: Service list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RegisteredServicesResponse'

  /v1/discovery/services/{service_name}:
    get:
      tags:
        - ServiceDiscovery
      summary: Get service endpoints
      description: Returns endpoints for a specific service
      operationId: getServiceEndpoints
      parameters:
        - name: service_name
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Service endpoints
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceEndpointsResponse'

  # =============================================================================
  # DISASTER RECOVERY (Component 38)
  # =============================================================================
  /v1/dr/status:
    get:
      tags:
        - DisasterRecovery
      summary: Get DR status
      description: Returns disaster recovery readiness status
      operationId: getDRStatus
      responses:
        '200':
          description: DR status
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DRStatusResponse'

  /v1/dr/failover:
    post:
      tags:
        - DisasterRecovery
      summary: Initiate failover
      description: Initiates failover to DR region (Chairman only)
      operationId: initiateFailover
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FailoverRequest'
      responses:
        '202':
          description: Failover initiated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FailoverResponse'

  # =============================================================================
  # SHADOW OF SHADOW (Component 39)
  # =============================================================================
  /v1/shadow-of-shadow/status:
    get:
      tags:
        - ShadowOfShadow
      summary: Get Shadow of Shadow status
      description: Returns status of the backup monitor
      operationId: getShadowOfShadowStatus
      responses:
        '200':
          description: Shadow of Shadow status
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShadowOfShadowStatusResponse'

  # =============================================================================
  # CI/CD PIPELINES (Component 40)
  # =============================================================================
  /v1/cicd/pipelines:
    get:
      tags:
        - CICD
      summary: List pipelines
      description: Returns all CI/CD pipelines and their status
      operationId: listPipelines
      responses:
        '200':
          description: Pipeline list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PipelineListResponse'

  /v1/cicd/pipelines/{pipeline_id}/runs:
    get:
      tags:
        - CICD
      summary: Get pipeline runs
      description: Returns recent runs for a pipeline
      operationId: getPipelineRuns
      parameters:
        - name: pipeline_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Pipeline runs
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PipelineRunsResponse'

  /v1/cicd/pipelines/{pipeline_id}/trigger:
    post:
      tags:
        - CICD
      summary: Trigger pipeline
      description: Manually trigger a pipeline run
      operationId: triggerPipeline
      parameters:
        - name: pipeline_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '202':
          description: Pipeline triggered
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PipelineTriggerResponse'

  # =============================================================================
  # CANARY DEPLOYMENT (Component 41)
  # =============================================================================
  /v1/canary/deployments:
    get:
      tags:
        - Canary
      summary: List canary deployments
      description: Returns all active canary deployments
      operationId: listCanaryDeployments
      responses:
        '200':
          description: Canary deployment list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CanaryListResponse'

  /v1/canary/deployments/{deployment_id}:
    get:
      tags:
        - Canary
      summary: Get canary status
      description: Returns status of a canary deployment
      operationId: getCanaryStatus
      parameters:
        - name: deployment_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Canary status
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CanaryStatusResponse'

  /v1/canary/deployments/{deployment_id}/promote:
    post:
      tags:
        - Canary
      summary: Promote canary
      description: Promote canary to full deployment
      operationId: promoteCanary
      parameters:
        - name: deployment_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '202':
          description: Promotion started
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /v1/canary/deployments/{deployment_id}/rollback:
    post:
      tags:
        - Canary
      summary: Rollback canary
      description: Rollback a canary deployment
      operationId: rollbackCanary
      parameters:
        - name: deployment_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '202':
          description: Rollback started
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # =============================================================================
  # SCHEDULER
  # =============================================================================
  /v1/scheduler/jobs:
    post:
      tags:
        - Scheduler
      summary: Create a scheduled job
      description: Create a new scheduled job (cron, one-time, or recurring)
      operationId: createScheduledJob
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ScheduledJobRequest'
      responses:
        '201':
          description: Job created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScheduledJobResponse'
    get:
      tags:
        - Scheduler
      summary: List all scheduled jobs
      description: Get a list of all scheduled jobs
      operationId: listScheduledJobs
      parameters:
        - name: status
          in: query
          schema:
            type: string
            enum: [active, paused, completed, failed]
      responses:
        '200':
          description: List of scheduled jobs
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScheduledJobListResponse'

  /v1/scheduler/jobs/{job_id}:
    get:
      tags:
        - Scheduler
      summary: Get job status
      description: Get the status and details of a scheduled job
      operationId: getScheduledJob
      parameters:
        - name: job_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Job details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScheduledJobDetailResponse'
    delete:
      tags:
        - Scheduler
      summary: Delete a scheduled job
      description: Delete a scheduled job by ID
      operationId: deleteScheduledJob
      parameters:
        - name: job_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '204':
          description: Job deleted

  # =============================================================================
  # NOTIFICATIONS
  # =============================================================================
  /v1/notifications:
    get:
      tags:
        - Notifications
      summary: Get all notifications
      description: Get all notifications for the current user
      operationId: getNotifications
      parameters:
        - name: unread_only
          in: query
          schema:
            type: boolean
            default: false
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
      responses:
        '200':
          description: List of notifications
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationListResponse'

  /v1/notifications/read:
    post:
      tags:
        - Notifications
      summary: Mark notifications as read
      description: Mark one or more notifications as read
      operationId: markNotificationsRead
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MarkNotificationsReadRequest'
      responses:
        '200':
          description: Notifications marked as read
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /v1/notifications/subscribe:
    post:
      tags:
        - Notifications
      summary: Subscribe to notification topics
      description: Subscribe to specific notification topics
      operationId: subscribeToNotifications
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NotificationSubscribeRequest'
      responses:
        '200':
          description: Subscription updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationSubscribeResponse'

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  responses:
    BadRequest:
      description: Invalid request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    Unauthorized:
      description: Authentication required
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    InternalError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

  schemas:
    # Common
    SuccessResponse:
      type: object
      required:
        - success
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Operation completed successfully"

    ErrorResponse:
      type: object
      required:
        - error
        - message
      properties:
        error:
          type: string
          example: "invalid_request"
        message:
          type: string
          example: "Missing required field: agent_id"

    ConstitutionBlockResponse:
      type: object
      required:
        - blocked
        - reason
        - article
      properties:
        blocked:
          type: boolean
          example: true
        reason:
          type: string
          example: "Command violates Article 3.2: No access to system files"
        article:
          type: string
          example: "3.2"

    # Health
    HealthResponse:
      type: object
      required:
        - status
        - version
      properties:
        status:
          type: string
          enum: [healthy, degraded, unhealthy]
        version:
          type: string
        services:
          type: object
          additionalProperties:
            type: string
            enum: [connected, disconnected]

    # Context
    ContextAssembleRequest:
      type: object
      required:
        - agent_id
      properties:
        agent_id:
          type: string
        task_type:
          type: string
        query:
          type: string
        topics:
          type: array
          items:
            type: string

    ContextAssembleResponse:
      type: object
      required:
        - tier1_tokens
        - tier2_tokens
        - tier3_tokens
        - total_tokens
      properties:
        tier1_tokens:
          type: integer
          example: 29679
        tier2_tokens:
          type: integer
          example: 39789
        tier3_tokens:
          type: integer
          example: 27264
        total_tokens:
          type: integer
          example: 96732
        tier1_docs:
          type: integer
        tier2_docs:
          type: integer
        tier3_docs:
          type: integer
        cache_hit:
          type: boolean
        assembly_time_ms:
          type: integer

    ContextInvalidateRequest:
      type: object
      properties:
        agent_id:
          type: string
          description: If omitted, invalidates all caches

    # Sandbox
    ExecuteRequest:
      type: object
      required:
        - agent_id
        - command
      properties:
        agent_id:
          type: string
        command:
          type: string
        timeout:
          type: integer
          default: 30
        working_dir:
          type: string

    ExecuteResponse:
      type: object
      required:
        - exit_code
        - stdout
        - stderr
      properties:
        exit_code:
          type: integer
        stdout:
          type: string
        stderr:
          type: string
        duration_ms:
          type: integer

    FileWriteRequest:
      type: object
      required:
        - agent_id
        - path
        - content
      properties:
        agent_id:
          type: string
        path:
          type: string
        content:
          type: string
        mode:
          type: string
          enum: [overwrite, append]
          default: overwrite

    FileReadResponse:
      type: object
      required:
        - content
      properties:
        content:
          type: string
        size:
          type: integer
        modified:
          type: string
          format: date-time

    GitCloneRequest:
      type: object
      required:
        - agent_id
        - repo_url
      properties:
        agent_id:
          type: string
        repo_url:
          type: string
        destination:
          type: string
        branch:
          type: string
          default: main

    GitCommitRequest:
      type: object
      required:
        - agent_id
        - repo_path
        - message
      properties:
        agent_id:
          type: string
        repo_path:
          type: string
        message:
          type: string
        files:
          type: array
          items:
            type: string
          default: ["."]

    GitCommitResponse:
      type: object
      required:
        - commit_hash
      properties:
        commit_hash:
          type: string
          example: "abc1234"

    GitPushRequest:
      type: object
      required:
        - agent_id
        - repo_path
      properties:
        agent_id:
          type: string
        repo_path:
          type: string
        branch:
          type: string
          default: main

    # Architect
    IndexRequest:
      type: object
      required:
        - path
        - content
      properties:
        path:
          type: string
        content:
          type: string
        metadata:
          type: object
          additionalProperties: true

    IndexResponse:
      type: object
      required:
        - indexed
        - document_id
      properties:
        indexed:
          type: boolean
        document_id:
          type: string
        chunks:
          type: integer

    SearchRequest:
      type: object
      required:
        - query
      properties:
        query:
          type: string
        limit:
          type: integer
          default: 10
        filters:
          type: object
          additionalProperties: true

    SearchResponse:
      type: object
      required:
        - results
      properties:
        results:
          type: array
          items:
            $ref: '#/components/schemas/SearchResult'
        total:
          type: integer

    SearchResult:
      type: object
      properties:
        document_id:
          type: string
        path:
          type: string
        content:
          type: string
        score:
          type: number
        metadata:
          type: object

    # Generative UI (PLANNED - BATCH-180)
    GenerateUIRequest:
      type: object
      required:
        - user_input
      properties:
        user_input:
          type: string
          description: Natural language description of desired UI
          example: "I want to learn Spanish"
        user_context:
          type: object
          properties:
            user_id:
              type: string
            preferences:
              type: object
              additionalProperties: true
        session_history:
          type: array
          items:
            type: object

    GenerateUIResponse:
      type: object
      required:
        - layout
        - components
      properties:
        title:
          type: string
          example: "Your Spanish Learning Journey"
        layout:
          type: string
          enum: [single-column, two-column, dashboard]
        components:
          type: array
          items:
            $ref: '#/components/schemas/UIComponent'
        animations:
          type: array
          items:
            $ref: '#/components/schemas/AnimationDefinition'
        cos_context:
          type: object
          properties:
            message:
              type: string
            suggestions:
              type: array
              items:
                type: string
        primary_action:
          type: object
          properties:
            label:
              type: string
            action:
              type: string

    UIComponent:
      type: object
      required:
        - type
        - props
      properties:
        id:
          type: string
        type:
          type: string
          enum: [roadmap, timeline, stepper, form, multiChoice, slider, card, grid, list, button, modal, tooltip, chart, table, metric, cosCompanion, suggestion, insight]
        props:
          type: object
          additionalProperties: true
        position:
          type: object
          properties:
            x:
              type: number
            y:
              type: number
            width:
              type: string
            height:
              type: string

    AnimationDefinition:
      type: object
      properties:
        target:
          type: string
        type:
          type: string
          enum: [fade-in, slide-up, scale, bounce]
        duration:
          type: number
        delay:
          type: number

    ComponentListResponse:
      type: object
      properties:
        components:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
              category:
                type: string
              description:
                type: string
              props_schema:
                type: object

    LayoutListResponse:
      type: object
      properties:
        layouts:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
              description:
                type: string
              preview_url:
                type: string

    RenderUIRequest:
      type: object
      required:
        - ui_spec
      properties:
        ui_spec:
          $ref: '#/components/schemas/GenerateUIResponse'
        format:
          type: string
          enum: [html, react, json]
          default: react

    RenderUIResponse:
      type: object
      properties:
        rendered:
          type: string
          description: Rendered UI code in requested format
        assets:
          type: array
          items:
            type: string
            description: URLs to required assets

    TemplateListResponse:
      type: object
      properties:
        templates:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
              name:
                type: string
              description:
                type: string
              category:
                type: string
              preview_url:
                type: string

    # GOD Mode
    SystemStatusResponse:
      type: object
      properties:
        status:
          type: string
          enum: [operational, degraded, critical]
        services:
          type: object
          additionalProperties:
            type: string
        active_agents:
          type: integer
        pending_approvals:
          type: integer
        events_last_hour:
          type: integer
        uptime_seconds:
          type: integer

    AgentListResponse:
      type: object
      properties:
        agents:
          type: array
          items:
            $ref: '#/components/schemas/AgentSummary'

    AgentSummary:
      type: object
      properties:
        agent_id:
          type: string
        name:
          type: string
        status:
          type: string
          enum: [active, idle, paused, error]
        current_task:
          type: string
        last_activity:
          type: string
          format: date-time

    AgentDetailResponse:
      type: object
      properties:
        agent_id:
          type: string
        name:
          type: string
        status:
          type: string
        current_task:
          type: string
        tasks_completed:
          type: integer
        errors:
          type: integer
        created_at:
          type: string
          format: date-time
        last_activity:
          type: string
          format: date-time
        recent_events:
          type: array
          items:
            $ref: '#/components/schemas/Event'

    PauseRequest:
      type: object
      properties:
        reason:
          type: string
        agent_id:
          type: string
          description: If omitted, pauses all agents

    OverrideRequest:
      type: object
      required:
        - decision_id
        - action
      properties:
        decision_id:
          type: string
        action:
          type: string
          enum: [approve, reject, modify]
        reason:
          type: string
        modified_value:
          type: object

    EventListResponse:
      type: object
      properties:
        events:
          type: array
          items:
            $ref: '#/components/schemas/Event'
        total:
          type: integer

    Event:
      type: object
      properties:
        event_id:
          type: string
        event_type:
          type: string
        agent_id:
          type: string
        timestamp:
          type: string
          format: date-time
        data:
          type: object

    ApprovalListResponse:
      type: object
      properties:
        approvals:
          type: array
          items:
            $ref: '#/components/schemas/PendingApproval'

    PendingApproval:
      type: object
      properties:
        approval_id:
          type: string
        agent_id:
          type: string
        action_type:
          type: string
        description:
          type: string
        requested_at:
          type: string
          format: date-time
        expires_at:
          type: string
          format: date-time
        data:
          type: object

    ApprovalDecisionRequest:
      type: object
      required:
        - decision
      properties:
        decision:
          type: string
          enum: [approve, reject]
        reason:
          type: string

    # =========================================================================
    # CONSTITUTION ENFORCER SCHEMAS
    # =========================================================================
    ConstitutionValidateRequest:
      type: object
      required:
        - action_type
        - action_data
      properties:
        action_type:
          type: string
          description: Type of action being validated
        action_data:
          type: object
          description: The action payload to validate
        agent_id:
          type: string
          description: Agent requesting validation

    ConstitutionValidateResponse:
      type: object
      required:
        - valid
      properties:
        valid:
          type: boolean
        violations:
          type: array
          items:
            $ref: '#/components/schemas/ConstitutionViolation'

    ConstitutionViolation:
      type: object
      properties:
        article:
          type: string
        section:
          type: string
        description:
          type: string
        severity:
          type: string
          enum: [critical, warning, info]

    ConstitutionArticlesResponse:
      type: object
      properties:
        articles:
          type: array
          items:
            $ref: '#/components/schemas/ConstitutionArticle'
        version:
          type: string
        last_updated:
          type: string
          format: date-time

    ConstitutionArticle:
      type: object
      properties:
        number:
          type: string
        title:
          type: string
        content:
          type: string
        sections:
          type: array
          items:
            type: object

    ViolationListResponse:
      type: object
      properties:
        violations:
          type: array
          items:
            $ref: '#/components/schemas/ViolationRecord'
        total:
          type: integer

    ViolationRecord:
      type: object
      properties:
        violation_id:
          type: string
        agent_id:
          type: string
        article:
          type: string
        description:
          type: string
        timestamp:
          type: string
          format: date-time
        action_blocked:
          type: boolean

    # =========================================================================
    # EVENT STORE SCHEMAS
    # =========================================================================
    EventQueryResponse:
      type: object
      properties:
        events:
          type: array
          items:
            $ref: '#/components/schemas/EventDetail'
        total:
          type: integer
        has_more:
          type: boolean

    EventDetail:
      type: object
      properties:
        event_id:
          type: string
        event_type:
          type: string
        agent_id:
          type: string
        timestamp:
          type: string
          format: date-time
        data:
          type: object
        metadata:
          type: object

    # =========================================================================
    # VALIDATOR SCHEMAS
    # =========================================================================
    ValidatorRequest:
      type: object
      required:
        - output_type
        - output_data
      properties:
        output_type:
          type: string
        output_data:
          type: object
        agent_id:
          type: string

    ValidatorResponse:
      type: object
      properties:
        valid:
          type: boolean
        errors:
          type: array
          items:
            type: string
        warnings:
          type: array
          items:
            type: string

    ValidationRulesResponse:
      type: object
      properties:
        rules:
          type: array
          items:
            type: object
            properties:
              rule_id:
                type: string
              name:
                type: string
              description:
                type: string
              enabled:
                type: boolean

    # =========================================================================
    # RED TEAM SCHEMAS
    # =========================================================================
    RedTeamRequest:
      type: object
      required:
        - action_type
        - action_data
      properties:
        action_type:
          type: string
        action_data:
          type: object
        context:
          type: object

    RedTeamResponse:
      type: object
      properties:
        risk_score:
          type: number
          minimum: 0
          maximum: 100
        vulnerabilities:
          type: array
          items:
            type: object
            properties:
              type:
                type: string
              severity:
                type: string
              description:
                type: string
        recommendation:
          type: string
          enum: [proceed, caution, block]

    RedTeamReportsResponse:
      type: object
      properties:
        reports:
          type: array
          items:
            type: object
            properties:
              report_id:
                type: string
              timestamp:
                type: string
                format: date-time
              risk_score:
                type: number
              summary:
                type: string

    # =========================================================================
    # SHADOW SCHEMAS
    # =========================================================================
    ShadowStatusResponse:
      type: object
      properties:
        status:
          type: string
          enum: [active, degraded, offline]
        last_check:
          type: string
          format: date-time
        monitored_services:
          type: integer
        active_alerts:
          type: integer

    ShadowAlertsResponse:
      type: object
      properties:
        alerts:
          type: array
          items:
            $ref: '#/components/schemas/ShadowAlert'

    ShadowAlert:
      type: object
      properties:
        alert_id:
          type: string
        severity:
          type: string
          enum: [critical, warning, info]
        service:
          type: string
        message:
          type: string
        timestamp:
          type: string
          format: date-time
        acknowledged:
          type: boolean

    # =========================================================================
    # AGENT RUNTIME SCHEMAS
    # =========================================================================
    AgentListResponse:
      type: object
      properties:
        agents:
          type: array
          items:
            $ref: '#/components/schemas/AgentSummary'

    AgentSummary:
      type: object
      properties:
        agent_id:
          type: string
        agent_type:
          type: string
        status:
          type: string
          enum: [running, idle, terminated]
        started_at:
          type: string
          format: date-time

    AgentDetailResponse:
      type: object
      properties:
        agent_id:
          type: string
        agent_type:
          type: string
        status:
          type: string
        started_at:
          type: string
          format: date-time
        current_task:
          type: string
        memory_usage:
          type: integer
        actions_executed:
          type: integer

    # =========================================================================
    # ORCHESTRATOR SCHEMAS
    # =========================================================================
    WorkflowListResponse:
      type: object
      properties:
        workflows:
          type: array
          items:
            $ref: '#/components/schemas/WorkflowSummary'

    WorkflowSummary:
      type: object
      properties:
        workflow_id:
          type: string
        name:
          type: string
        status:
          type: string
          enum: [active, completed, failed, cancelled]
        started_at:
          type: string
          format: date-time
        progress:
          type: number

    WorkflowDetailResponse:
      type: object
      properties:
        workflow_id:
          type: string
        name:
          type: string
        status:
          type: string
        started_at:
          type: string
          format: date-time
        completed_at:
          type: string
          format: date-time
        steps:
          type: array
          items:
            type: object
            properties:
              step_id:
                type: string
              name:
                type: string
              status:
                type: string
              agent_id:
                type: string

    # =========================================================================
    # ACTION QUEUE SCHEMAS
    # =========================================================================
    ActionQueueResponse:
      type: object
      properties:
        actions:
          type: array
          items:
            $ref: '#/components/schemas/QueuedAction'
        total:
          type: integer

    QueuedAction:
      type: object
      properties:
        action_id:
          type: string
        agent_id:
          type: string
        action_type:
          type: string
        priority:
          type: string
          enum: [high, medium, low]
        queued_at:
          type: string
          format: date-time
        status:
          type: string
          enum: [pending, processing, completed, failed]

    ActionDetailResponse:
      type: object
      properties:
        action_id:
          type: string
        agent_id:
          type: string
        action_type:
          type: string
        priority:
          type: string
        queued_at:
          type: string
          format: date-time
        status:
          type: string
        data:
          type: object
        result:
          type: object

    # =========================================================================
    # TREASURY SCHEMAS
    # =========================================================================
    TreasuryBalanceResponse:
      type: object
      properties:
        balance:
          type: number
        budget:
          type: number
        spent_today:
          type: number
        spent_this_month:
          type: number
        currency:
          type: string
          default: USD

    TreasuryTransactionsResponse:
      type: object
      properties:
        transactions:
          type: array
          items:
            $ref: '#/components/schemas/TreasuryTransaction'
        total:
          type: integer

    TreasuryTransaction:
      type: object
      properties:
        transaction_id:
          type: string
        agent_id:
          type: string
        amount:
          type: number
        description:
          type: string
        timestamp:
          type: string
          format: date-time
        category:
          type: string

    TreasuryBudgetResponse:
      type: object
      properties:
        daily_limit:
          type: number
        monthly_limit:
          type: number
        alert_threshold:
          type: number
        auto_pause_threshold:
          type: number

    TreasuryBudgetUpdateRequest:
      type: object
      properties:
        daily_limit:
          type: number
        monthly_limit:
          type: number
        alert_threshold:
          type: number
        auto_pause_threshold:
          type: number

    # =========================================================================
    # STATE MANAGER SCHEMAS
    # =========================================================================
    SystemStateResponse:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
        services:
          type: object
          additionalProperties:
            type: object
        agents:
          type: object
          additionalProperties:
            type: object
        system:
          type: object

    AgentStateResponse:
      type: object
      properties:
        agent_id:
          type: string
        status:
          type: string
        current_task:
          type: string
        memory:
          type: object
        last_action:
          type: string
          format: date-time

    StateHistoryResponse:
      type: object
      properties:
        snapshots:
          type: array
          items:
            type: object
            properties:
              snapshot_id:
                type: string
              timestamp:
                type: string
                format: date-time
              summary:
                type: object

    # =========================================================================
    # APPROVAL ENGINE SCHEMAS
    # =========================================================================
    ApprovalDetailResponse:
      type: object
      properties:
        approval_id:
          type: string
        agent_id:
          type: string
        action_type:
          type: string
        description:
          type: string
        status:
          type: string
          enum: [pending, approved, rejected, expired]
        requested_at:
          type: string
          format: date-time
        decided_at:
          type: string
          format: date-time
        decided_by:
          type: string
        reason:
          type: string
        data:
          type: object

    # =========================================================================
    # COST MODEL SCHEMAS
    # =========================================================================
    CostEstimateRequest:
      type: object
      required:
        - action_type
      properties:
        action_type:
          type: string
        parameters:
          type: object
        agent_id:
          type: string

    CostEstimateResponse:
      type: object
      properties:
        estimated_cost:
          type: number
        currency:
          type: string
          default: USD
        breakdown:
          type: array
          items:
            type: object
            properties:
              component:
                type: string
              cost:
                type: number
        confidence:
          type: number
          minimum: 0
          maximum: 1

    CostModelsResponse:
      type: object
      properties:
        models:
          type: array
          items:
            type: object
            properties:
              model_id:
                type: string
              name:
                type: string
              description:
                type: string
              parameters:
                type: object

    # =========================================================================
    # MEMORY CONTROLLER SCHEMAS
    # =========================================================================
    AgentMemoryResponse:
      type: object
      properties:
        agent_id:
          type: string
        working_memory:
          type: object
        memory_size:
          type: integer
        last_updated:
          type: string
          format: date-time

    # =========================================================================
    # RAM AGENT SCHEMAS
    # =========================================================================
    CacheStatsResponse:
      type: object
      properties:
        hits:
          type: integer
        misses:
          type: integer
        hit_rate:
          type: number
        size:
          type: integer
        max_size:
          type: integer
        evictions:
          type: integer

    CacheInvalidateRequest:
      type: object
      properties:
        keys:
          type: array
          items:
            type: string
        pattern:
          type: string
        all:
          type: boolean
          default: false

    # =========================================================================
    # SERVICE ADAPTERS SCHEMAS
    # =========================================================================
    AdapterListResponse:
      type: object
      properties:
        adapters:
          type: array
          items:
            $ref: '#/components/schemas/AdapterSummary'

    AdapterSummary:
      type: object
      properties:
        adapter_id:
          type: string
        name:
          type: string
        type:
          type: string
        status:
          type: string
          enum: [connected, disconnected, error]

    AdapterStatusResponse:
      type: object
      properties:
        adapter_id:
          type: string
        name:
          type: string
        status:
          type: string
        last_used:
          type: string
          format: date-time
        requests_today:
          type: integer
        errors_today:
          type: integer

    # =========================================================================
    # BACKUP SERVICE SCHEMAS
    # =========================================================================
    BackupListResponse:
      type: object
      properties:
        snapshots:
          type: array
          items:
            $ref: '#/components/schemas/BackupSummary'

    BackupSummary:
      type: object
      properties:
        snapshot_id:
          type: string
        created_at:
          type: string
          format: date-time
        size:
          type: integer
        type:
          type: string
          enum: [full, incremental]
        status:
          type: string
          enum: [completed, in_progress, failed]

    BackupCreateRequest:
      type: object
      properties:
        type:
          type: string
          enum: [full, incremental]
          default: incremental
        description:
          type: string

    BackupCreateResponse:
      type: object
      properties:
        snapshot_id:
          type: string
        status:
          type: string
        estimated_completion:
          type: string
          format: date-time

    BackupDetailResponse:
      type: object
      properties:
        snapshot_id:
          type: string
        created_at:
          type: string
          format: date-time
        completed_at:
          type: string
          format: date-time
        size:
          type: integer
        type:
          type: string
        status:
          type: string
        components:
          type: array
          items:
            type: string

    BackupRestoreRequest:
      type: object
      required:
        - snapshot_id
      properties:
        snapshot_id:
          type: string
        components:
          type: array
          items:
            type: string
          description: Specific components to restore (empty = all)

    BackupRestoreResponse:
      type: object
      properties:
        restore_id:
          type: string
        status:
          type: string
        estimated_completion:
          type: string
          format: date-time

    # =========================================================================
    # HEALTH MONITOR SCHEMAS
    # =========================================================================
    ServiceHealthListResponse:
      type: object
      properties:
        services:
          type: array
          items:
            $ref: '#/components/schemas/ServiceHealthResponse'

    ServiceHealthResponse:
      type: object
      properties:
        service_id:
          type: string
        name:
          type: string
        status:
          type: string
          enum: [healthy, degraded, unhealthy]
        last_check:
          type: string
          format: date-time
        latency_ms:
          type: integer
        uptime_percent:
          type: number

    # =========================================================================
    # HEALTH AGGREGATOR SCHEMAS
    # =========================================================================
    AggregatedHealthResponse:
      type: object
      properties:
        overall_status:
          type: string
          enum: [healthy, degraded, unhealthy]
        healthy_services:
          type: integer
        total_services:
          type: integer
        degraded_services:
          type: array
          items:
            type: string
        unhealthy_services:
          type: array
          items:
            type: string
        trend:
          type: string
          enum: [improving, stable, degrading]

    HealthTrendsResponse:
      type: object
      properties:
        period:
          type: string
        data_points:
          type: array
          items:
            type: object
            properties:
              timestamp:
                type: string
                format: date-time
              healthy_count:
                type: integer
              degraded_count:
                type: integer
              unhealthy_count:
                type: integer

    # =========================================================================
    # ROLLBACK SCHEMAS
    # =========================================================================
    DeploymentListResponse:
      type: object
      properties:
        deployments:
          type: array
          items:
            type: object
            properties:
              deployment_id:
                type: string
              version:
                type: string
              deployed_at:
                type: string
                format: date-time
              status:
                type: string
              can_rollback:
                type: boolean

    RollbackRequest:
      type: object
      required:
        - deployment_id
      properties:
        deployment_id:
          type: string
        reason:
          type: string

    RollbackResponse:
      type: object
      properties:
        rollback_id:
          type: string
        status:
          type: string
        target_version:
          type: string
        estimated_completion:
          type: string
          format: date-time

    # =========================================================================
    # DEAD MAN'S SWITCH SCHEMAS
    # =========================================================================
    DeadManStatusResponse:
      type: object
      properties:
        status:
          type: string
          enum: [armed, disarmed, triggered]
        last_heartbeat:
          type: string
          format: date-time
        timeout_seconds:
          type: integer
        time_remaining:
          type: integer

    # =========================================================================
    # DEPENDENCY GRAPH SCHEMAS
    # =========================================================================
    DependencyGraphResponse:
      type: object
      properties:
        nodes:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
              name:
                type: string
              type:
                type: string
        edges:
          type: array
          items:
            type: object
            properties:
              from:
                type: string
              to:
                type: string
              type:
                type: string

    BuildOrderResponse:
      type: object
      properties:
        order:
          type: array
          items:
            type: object
            properties:
              phase:
                type: integer
              components:
                type: array
                items:
                  type: string

    # =========================================================================
    # CONFIGURATION MANAGEMENT SCHEMAS
    # =========================================================================
    ConfigResponse:
      type: object
      properties:
        config:
          type: object
          additionalProperties: true
        version:
          type: string
        last_updated:
          type: string
          format: date-time

    ConfigValueResponse:
      type: object
      properties:
        key:
          type: string
        value:
          type: object
        type:
          type: string
        last_updated:
          type: string
          format: date-time

    ConfigUpdateRequest:
      type: object
      required:
        - value
      properties:
        value:
          type: object
        reason:
          type: string

    # =========================================================================
    # SERVICE DISCOVERY SCHEMAS
    # =========================================================================
    RegisteredServicesResponse:
      type: object
      properties:
        services:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
              instances:
                type: integer
              healthy_instances:
                type: integer

    ServiceEndpointsResponse:
      type: object
      properties:
        service_name:
          type: string
        endpoints:
          type: array
          items:
            type: object
            properties:
              address:
                type: string
              port:
                type: integer
              healthy:
                type: boolean
              metadata:
                type: object

    # =========================================================================
    # DISASTER RECOVERY SCHEMAS
    # =========================================================================
    DRStatusResponse:
      type: object
      properties:
        primary_region:
          type: string
        dr_region:
          type: string
        replication_lag_seconds:
          type: integer
        last_sync:
          type: string
          format: date-time
        ready_for_failover:
          type: boolean
        rto_minutes:
          type: integer
        rpo_minutes:
          type: integer

    FailoverRequest:
      type: object
      properties:
        target_region:
          type: string
        reason:
          type: string
        force:
          type: boolean
          default: false

    FailoverResponse:
      type: object
      properties:
        failover_id:
          type: string
        status:
          type: string
        target_region:
          type: string
        estimated_completion:
          type: string
          format: date-time

    # =========================================================================
    # SHADOW OF SHADOW SCHEMAS
    # =========================================================================
    ShadowOfShadowStatusResponse:
      type: object
      properties:
        status:
          type: string
          enum: [active, standby, offline]
        shadow_status:
          type: string
          enum: [healthy, degraded, unhealthy]
        last_check:
          type: string
          format: date-time
        takeover_ready:
          type: boolean

    # =========================================================================
    # CI/CD SCHEMAS
    # =========================================================================
    PipelineListResponse:
      type: object
      properties:
        pipelines:
          type: array
          items:
            type: object
            properties:
              pipeline_id:
                type: string
              name:
                type: string
              status:
                type: string
              last_run:
                type: string
                format: date-time

    PipelineRunsResponse:
      type: object
      properties:
        runs:
          type: array
          items:
            type: object
            properties:
              run_id:
                type: string
              status:
                type: string
                enum: [pending, running, success, failed, cancelled]
              started_at:
                type: string
                format: date-time
              completed_at:
                type: string
                format: date-time
              commit:
                type: string

    PipelineTriggerResponse:
      type: object
      properties:
        run_id:
          type: string
        status:
          type: string
        pipeline_id:
          type: string

    # =========================================================================
    # CANARY DEPLOYMENT SCHEMAS
    # =========================================================================
    CanaryListResponse:
      type: object
      properties:
        deployments:
          type: array
          items:
            $ref: '#/components/schemas/CanaryStatusResponse'

    CanaryStatusResponse:
      type: object
      properties:
        deployment_id:
          type: string
        service:
          type: string
        version:
          type: string
        traffic_percent:
          type: integer
        status:
          type: string
          enum: [active, promoting, rolling_back, completed]
        started_at:
          type: string
          format: date-time
        metrics:
          type: object
          properties:
            error_rate:
              type: number
            latency_p99:
              type: number
            success_rate:
              type: number

    # =========================================================================
    # SCHEDULER SCHEMAS
    # =========================================================================
    ScheduledJobRequest:
      type: object
      required:
        - name
        - job_type
        - action
      properties:
        name:
          type: string
          description: Human-readable name for the job
        job_type:
          type: string
          enum: [cron, one_time, interval]
          description: Type of scheduled job
        cron_expression:
          type: string
          description: Cron expression (required for cron type)
        run_at:
          type: string
          format: date-time
          description: When to run (required for one_time type)
        interval_seconds:
          type: integer
          description: Interval in seconds (required for interval type)
        action:
          type: object
          description: The action to perform when triggered
          properties:
            type:
              type: string
              enum: [http, agent_task, notification]
            payload:
              type: object
        enabled:
          type: boolean
          default: true

    ScheduledJobResponse:
      type: object
      properties:
        job_id:
          type: string
        name:
          type: string
        job_type:
          type: string
        status:
          type: string
          enum: [active, paused, completed, failed]
        created_at:
          type: string
          format: date-time
        next_run:
          type: string
          format: date-time

    ScheduledJobListResponse:
      type: object
      properties:
        jobs:
          type: array
          items:
            $ref: '#/components/schemas/ScheduledJobResponse'
        total:
          type: integer

    ScheduledJobDetailResponse:
      type: object
      properties:
        job_id:
          type: string
        name:
          type: string
        job_type:
          type: string
        cron_expression:
          type: string
        status:
          type: string
          enum: [active, paused, completed, failed]
        created_at:
          type: string
          format: date-time
        last_run:
          type: string
          format: date-time
        next_run:
          type: string
          format: date-time
        run_count:
          type: integer
        last_result:
          type: object
          properties:
            success:
              type: boolean
            message:
              type: string
            timestamp:
              type: string
              format: date-time

    # =========================================================================
    # NOTIFICATIONS SCHEMAS
    # =========================================================================
    NotificationListResponse:
      type: object
      properties:
        notifications:
          type: array
          items:
            $ref: '#/components/schemas/Notification'
        unread_count:
          type: integer
        total:
          type: integer

    Notification:
      type: object
      properties:
        notification_id:
          type: string
        type:
          type: string
          enum: [info, warning, error, success, task_complete, budget_alert, system_status]
        title:
          type: string
        message:
          type: string
        read:
          type: boolean
        created_at:
          type: string
          format: date-time
        data:
          type: object
          description: Additional notification-specific data

    MarkNotificationsReadRequest:
      type: object
      properties:
        notification_ids:
          type: array
          items:
            type: string
          description: List of notification IDs to mark as read
        all:
          type: boolean
          default: false
          description: Mark all notifications as read

    NotificationSubscribeRequest:
      type: object
      required:
        - topics
      properties:
        topics:
          type: array
          items:
            type: string
            enum: [task_complete, budget_alert, system_status, agent_updates, security_alerts]
          description: Topics to subscribe to
        channels:
          type: array
          items:
            type: string
            enum: [in_app, email, webhook]
          description: Delivery channels

    NotificationSubscribeResponse:
      type: object
      properties:
        subscriptions:
          type: array
          items:
            type: object
            properties:
              topic:
                type: string
              channels:
                type: array
                items:
                  type: string
              subscribed_at:
                type: string
                format: date-time

security:
  - BearerAuth: []
